import{b as c}from"./chunk-JM6GRGRY.js";import{signal as E,inject as y}from"@angular/core";import{RouterOutlet as F,RouterModule as A,Router as D}from"@angular/router";import{ActivatedRoute as B}from"@angular/router";import{CommonModule as _}from"@angular/common";import{FormsModule as k}from"@angular/forms";import*as e from"@angular/core";import{BehaviorSubject as v}from"rxjs";import*as d from"@angular/core";import*as C from"@angular/common/http";var p=class r{constructor(n){this.http=n;console.log("TenantService constructor - starting..."),this.loadDefaultTenant()}currentTenantSubject=new v(null);currentTenant$=this.currentTenantSubject.asObservable();loadingSubject=new v(!1);loading$=this.loadingSubject.asObservable();errorSubject=new v(null);error$=this.errorSubject.asObservable();tenantId="";isInitialized=!1;loadDefaultTenant(){console.log("Loading default tenant configuration..."),this.setLoading(!0);let n={id:"default",name:"School Management System",displayName:"BuildAQ Schools",domain:window.location.hostname,status:"active",adminEmail:"admin@buildaq.com",adminName:"System Administrator",features:{gradebook:!0,reports:!0,analytics:!0,bulkOperations:!0,dataExport:!0,realTimeUpdates:!0,notifications:!0,customBranding:!0,apiAccess:!0,advancedReporting:!0},branding:{logo:"",favicon:"/favicon.ico",primaryColor:"#3498db",secondaryColor:"#2ecc71",accentColor:"#f39c12",logoUrl:"",fontFamily:"Inter, sans-serif"},settings:{timezone:"America/New_York",dateFormat:"MM/DD/YYYY",timeFormat:"12h",currency:"USD",language:"en-US",academicYear:{start:"2025-08-15",end:"2026-06-15"},gradingScale:{A:90,B:80,C:70,D:60,F:0},classPeriods:{1:"08:00-08:50",2:"09:00-09:50",3:"10:00-10:50",4:"11:00-11:50",5:"12:00-12:50",6:"13:00-13:50",7:"14:00-14:50",8:"15:00-15:50"},schoolHours:{start:"07:30",end:"16:00"}},subscription:{plan:"enterprise",status:"active",limits:{maxStudents:1e4,maxTeachers:1e3,maxClasses:2e3,maxStorageGB:100,maxApiCalls:1e5},usage:{students:0,teachers:0,classes:0,storageGB:0,apiCalls:0}},createdAt:new Date,updatedAt:new Date,dataRegion:"US-East",complianceLevel:"ferpa",ssoEnabled:!1,mfaRequired:!1};this.setCurrentTenant(n),this.applyTenantConfiguration(n),this.isInitialized=!0,this.setLoading(!1),console.log("Default tenant loaded successfully:",n.name)}setCurrentTenant(n){this.currentTenantSubject.next(n)}applyTenantConfiguration(n){this.applyBranding(n.branding),this.updatePageTitle(n.displayName),this.updateFavicon(n.branding.favicon)}applyBranding(n){let t=document.documentElement;t.style.setProperty("--primary-color",n.primaryColor),t.style.setProperty("--secondary-color",n.secondaryColor),t.style.setProperty("--accent-color",n.accentColor||n.primaryColor),n.fontFamily&&t.style.setProperty("--font-family",n.fontFamily)}updatePageTitle(n){document.title=`${n} - School Management`}updateFavicon(n){if(n){let t=document.querySelector('link[rel="icon"]');t||(t=document.createElement("link"),t.rel="icon",document.head.appendChild(t)),t.href=n}}getCurrentTenant(){return this.currentTenantSubject.value}getTenantId(){return this.tenantId||"default"}isFeatureEnabled(n){return this.getCurrentTenant()?.features[n]||!1}isReady(){return this.isInitialized&&this.currentTenantSubject.value!==null}updateFeatures(n){let t=this.getCurrentTenant();t&&(t.features=Object.assign({},t.features,n),t.updatedAt=new Date,this.setCurrentTenant(t))}setPlan(n){let t=this.getCurrentTenant();if(t){switch(t.subscription.plan=n,n){case"free":t.features={gradebook:!1,reports:!1,analytics:!1,bulkOperations:!1,dataExport:!1,realTimeUpdates:!1,notifications:!1,customBranding:!1,apiAccess:!1,advancedReporting:!1};break;case"basic":t.features={gradebook:!0,reports:!0,analytics:!1,bulkOperations:!0,dataExport:!1,realTimeUpdates:!1,notifications:!0,customBranding:!1,apiAccess:!0,advancedReporting:!1};break;case"premium":t.features={gradebook:!0,reports:!0,analytics:!0,bulkOperations:!0,dataExport:!0,realTimeUpdates:!0,notifications:!0,customBranding:!0,apiAccess:!0,advancedReporting:!0};break;case"enterprise":default:t.features={gradebook:!0,reports:!0,analytics:!0,bulkOperations:!0,dataExport:!0,realTimeUpdates:!0,notifications:!0,customBranding:!0,apiAccess:!0,advancedReporting:!0};break}t.updatedAt=new Date,this.setCurrentTenant(t),this.applyTenantConfiguration(t)}}setLoading(n){this.loadingSubject.next(n)}setError(n){this.errorSubject.next(n)}static \u0275fac=function(t){return new(t||r)(d.\u0275\u0275inject(C.HttpClient))};static \u0275prov=d.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"})};import*as u from"@angular/common";import*as g from"@angular/forms";import*as f from"@angular/material/input";import*as b from"@angular/material/select";import*as T from"@angular/material/checkbox";function P(r,n){if(r&1&&(e.\u0275\u0275elementStart(0,"mat-option",9),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"titlecase"),e.\u0275\u0275elementEnd()),r&2){let t=n.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,2,t))}}function O(r,n){if(r&1){let t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",10)(1,"mat-checkbox",11),e.\u0275\u0275listener("change",function(){let o=e.\u0275\u0275restoreView(t).$implicit,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.toggleFeature(o))}),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()}if(r&2){let t=n.$implicit,i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275property("checked",i.features[t]),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(t)}}var m=class r{constructor(n){this.tenant=n;let t=this.tenant.getCurrentTenant();this.currentPlan=t?.subscription?.plan??"enterprise",this.features=Object.assign({},t?.features||{})}plans=["free","basic","premium","enterprise"];currentPlan="enterprise";features={};setPlan(n){this.currentPlan=n,this.tenant.setPlan(n);let t=this.tenant.getCurrentTenant();this.features=Object.assign({},t?.features||{})}toggleFeature(n){this.features[n]=!this.features[n];let t={};t[n]=this.features[n],this.tenant.updateFeatures(t)}get keys(){return Object.keys(this.features||{})}static \u0275fac=function(t){return new(t||r)(e.\u0275\u0275directiveInject(p))};static \u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["app-tenant-switcher"]],decls:14,vars:4,consts:[[1,"tenant-switcher"],[1,"tenant-header"],[1,"tenant-name"],[1,"plan-select"],["appearance","outline"],["id","plan",3,"ngModelChange","selectionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"feature-list"],["class","feature",4,"ngFor","ngForOf"],[3,"value"],[1,"feature"],[3,"change","checked"]],template:function(t,i){if(t&1&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2),e.\u0275\u0275text(3,"Tenant: "),e.\u0275\u0275elementStart(4,"strong"),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"div",3)(7,"mat-form-field",4)(8,"mat-label"),e.\u0275\u0275text(9,"Plan"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"mat-select",5),e.\u0275\u0275twoWayListener("ngModelChange",function(s){return e.\u0275\u0275twoWayBindingSet(i.currentPlan,s)||(i.currentPlan=s),s}),e.\u0275\u0275listener("selectionChange",function(s){return i.setPlan(s.value)}),e.\u0275\u0275template(11,P,3,4,"mat-option",6),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(12,"div",7),e.\u0275\u0275template(13,O,3,2,"div",8),e.\u0275\u0275elementEnd()()),t&2){let o;e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(((o=i.tenant.getCurrentTenant())==null?null:o.displayName)||"Default"),e.\u0275\u0275advance(5),e.\u0275\u0275twoWayProperty("ngModel",i.currentPlan),e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",i.plans),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",i.keys)}},dependencies:[_,u.NgForOf,k,g.NgControlStatus,g.NgModel,c,f.MatFormField,f.MatLabel,b.MatSelect,b.MatOption,T.MatCheckbox,u.TitleCasePipe],styles:[".tenant-switcher[_ngcontent-%COMP%]{padding:8px 12px;border-bottom:1px solid rgba(0,0,0,.06)}.tenant-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:8px}.tenant-name[_ngcontent-%COMP%]{font-size:13px}.plan-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:4px 6px;font-size:13px}.feature-list[_ngcontent-%COMP%]{margin-top:8px;display:flex;flex-wrap:wrap;gap:6px}.feature[_ngcontent-%COMP%]{font-size:12px;background:#00000008;padding:4px 6px;border-radius:4px}"]})};import*as a from"@angular/core";import*as S from"@angular/router";import*as w from"@angular/material/toolbar";import*as h from"@angular/material/list";import*as l from"@angular/material/sidenav";var x=class r{title=E("buildaq-healthcare");router=y(D);route=y(B);constructor(){}ngOnInit(){let n=new URLSearchParams(window.location.search),t=n.get("authToken");if(t){localStorage.setItem("shellAuthToken",t),localStorage.setItem("auth_token",t),window.parent!==window&&window.parent.postMessage({type:"healthcare-ready",token:t},"*");let o=new URL(window.location.href);o.searchParams.delete("authToken"),window.history.replaceState({},"",o.pathname+o.hash)}let i=n.get("goto");if(i)try{setTimeout(()=>{try{this.router.navigate([i])}catch(o){console.warn("goto navigation failed",o)}},50)}catch(o){console.warn("Failed to process goto query param",o)}}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=a.\u0275\u0275defineComponent({type:r,selectors:[["app-root"]],decls:22,vars:0,consts:[[1,"app-shell"],[1,"app-sidenav-container"],["mode","side","opened","",1,"app-sidebar"],["color","primary",1,"brand"],["mat-list-item","","routerLink","/dashboard"],["mat-list-item","","routerLink","/patients"],["mat-list-item","","routerLink","/appointments"],["mat-list-item","","routerLink","/beds"],["mat-list-item","","routerLink","/billing"],["mat-list-item","","routerLink","/announcements"],[1,"app-main"]],template:function(t,i){t&1&&(a.\u0275\u0275elementStart(0,"div",0)(1,"mat-sidenav-container",1)(2,"mat-sidenav",2)(3,"mat-toolbar",3),a.\u0275\u0275text(4,"BuildAQ Healthcare"),a.\u0275\u0275elementEnd(),a.\u0275\u0275element(5,"app-tenant-switcher"),a.\u0275\u0275elementStart(6,"mat-nav-list")(7,"a",4),a.\u0275\u0275text(8,"Dashboard"),a.\u0275\u0275elementEnd(),a.\u0275\u0275elementStart(9,"a",5),a.\u0275\u0275text(10,"Patients"),a.\u0275\u0275elementEnd(),a.\u0275\u0275elementStart(11,"a",6),a.\u0275\u0275text(12,"Appointments"),a.\u0275\u0275elementEnd(),a.\u0275\u0275elementStart(13,"a",7),a.\u0275\u0275text(14,"Bed Management"),a.\u0275\u0275elementEnd(),a.\u0275\u0275elementStart(15,"a",8),a.\u0275\u0275text(16,"Billing"),a.\u0275\u0275elementEnd(),a.\u0275\u0275elementStart(17,"a",9),a.\u0275\u0275text(18,"Announcements"),a.\u0275\u0275elementEnd()()(),a.\u0275\u0275elementStart(19,"mat-sidenav-content")(20,"main",10),a.\u0275\u0275element(21,"router-outlet"),a.\u0275\u0275elementEnd()()()())},dependencies:[F,A,S.RouterLink,m,c,w.MatToolbar,h.MatNavList,h.MatListItem,l.MatSidenav,l.MatSidenavContainer,l.MatSidenavContent],styles:[".app-shell[_ngcontent-%COMP%]{display:flex}.app-sidebar[_ngcontent-%COMP%]{width:220px;background:#1f2937;color:#fff;min-height:100vh;padding:1rem}.brand[_ngcontent-%COMP%]{font-weight:700;margin-bottom:1rem}.nav[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.nav-link[_ngcontent-%COMP%]{color:#d1d5db;text-decoration:none;padding:.5rem;border-radius:6px}.nav-link[_ngcontent-%COMP%]:hover{background:#ffffff0a;color:#fff}.app-main[_ngcontent-%COMP%]{flex:1;padding:1rem;background:#f3f4f6;min-height:100vh}.page[_ngcontent-%COMP%]{background:#fff;padding:1rem;border-radius:10px;box-shadow:0 4px 12px #0206170f}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem;border-bottom:1px solid #eee;text-align:left}.class-card[_ngcontent-%COMP%]{background:#f8fafc;padding:.75rem;border-radius:8px;margin-bottom:.5rem}"]})};export{x as App};
